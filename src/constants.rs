/// Preevaluated values for (n i), with 2^n (i.e. the sum of (n i)) in value\[0\]
///
/// i.e. (n i) is in `BINOMIALS[n][i+1]`
///
/// As a check, (6 2) = 6!/(2!.4!) = 6*5/2 = 15 = BINOMIALS\[6\]\[2+1\]
pub const BINOMIALS_U: &[&[usize]] = &[
    &[1, 1],
    &[2, 1, 1],
    &[4, 1, 2, 1],
    &[8, 1, 3, 3, 1],
    &[16, 1, 4, 6, 4, 1],
    &[32, 1, 5, 10, 10, 5, 1],
    &[64, 1, 6, 15, 20, 15, 6, 1],
    &[128, 1, 7, 21, 35, 35, 21, 7, 1],
    &[256, 1, 8, 28, 56, 70, 56, 28, 8, 1],
    &[512, 1, 9, 36, 84, 126, 126, 84, 36, 9, 1],
    &[1024, 1, 10, 45, 120, 210, 252, 210, 120, 45, 10, 1],
    &[2048, 1, 11, 55, 165, 330, 462, 462, 330, 165, 55, 11, 1],
    &[
        4096, 1, 12, 66, 220, 495, 792, 924, 792, 495, 220, 66, 12, 1,
    ],
    &[
        8192, 1, 13, 78, 286, 715, 1287, 1716, 1716, 1287, 715, 286, 78, 13, 1,
    ],
    &[
        16384, 1, 14, 91, 364, 1001, 2002, 3003, 3432, 3003, 2002, 1001, 364, 91, 14, 1,
    ],
    &[
        32768, 1, 15, 105, 455, 1365, 3003, 5005, 6435, 6435, 5005, 3003, 1365, 455, 105, 15, 1,
    ],
    &[
        65536, 1, 16, 120, 560, 1820, 4368, 8008, 11440, 12870, 11440, 8008, 4368, 1820, 560, 120,
        16, 1,
    ],
    &[
        131072, 1, 17, 136, 680, 2380, 6188, 12376, 19448, 24310, 24310, 19448, 12376, 6188, 2380,
        680, 136, 17, 1,
    ],
    &[
        262144, 1, 18, 153, 816, 3060, 8568, 18564, 31824, 43758, 48620, 43758, 31824, 18564, 8568,
        3060, 816, 153, 18, 1,
    ],
    &[
        524288, 1, 19, 171, 969, 3876, 11628, 27132, 50388, 75582, 92378, 92378, 75582, 50388,
        27132, 11628, 3876, 969, 171, 19, 1,
    ],
    &[
        1048576, 1, 20, 190, 1140, 4845, 15504, 38760, 77520, 125970, 167960, 184756, 167960,
        125970, 77520, 38760, 15504, 4845, 1140, 190, 20, 1,
    ],
    &[
        2097152, 1, 21, 210, 1330, 5985, 20349, 54264, 116280, 203490, 293930, 352716, 352716,
        293930, 203490, 116280, 54264, 20349, 5985, 1330, 210, 21, 1,
    ],
    &[
        4194304, 1, 22, 231, 1540, 7315, 26334, 74613, 170544, 319770, 497420, 646646, 705432,
        646646, 497420, 319770, 170544, 74613, 26334, 7315, 1540, 231, 22, 1,
    ],
    &[
        8388608, 1, 23, 253, 1771, 8855, 33649, 100947, 245157, 490314, 817190, 1144066, 1352078,
        1352078, 1144066, 817190, 490314, 245157, 100947, 33649, 8855, 1771, 253, 23, 1,
    ],
    &[
        16777216, 1, 24, 276, 2024, 10626, 42504, 134596, 346104, 735471, 1307504, 1961256,
        2496144, 2704156, 2496144, 1961256, 1307504, 735471, 346104, 134596, 42504, 10626, 2024,
        276, 24, 1,
    ],
    &[
        33554432, 1, 25, 300, 2300, 12650, 53130, 177100, 480700, 1081575, 2042975, 3268760,
        4457400, 5200300, 5200300, 4457400, 3268760, 2042975, 1081575, 480700, 177100, 53130,
        12650, 2300, 300, 25, 1,
    ],
    &[
        67108864, 1, 26, 325, 2600, 14950, 65780, 230230, 657800, 1562275, 3124550, 5311735,
        7726160, 9657700, 10400600, 9657700, 7726160, 5311735, 3124550, 1562275, 657800, 230230,
        65780, 14950, 2600, 325, 26, 1,
    ],
    &[
        134217728, 1, 27, 351, 2925, 17550, 80730, 296010, 888030, 2220075, 4686825, 8436285,
        13037895, 17383860, 20058300, 20058300, 17383860, 13037895, 8436285, 4686825, 2220075,
        888030, 296010, 80730, 17550, 2925, 351, 27, 1,
    ],
    &[
        268435456, 1, 28, 378, 3276, 20475, 98280, 376740, 1184040, 3108105, 6906900, 13123110,
        21474180, 30421755, 37442160, 40116600, 37442160, 30421755, 21474180, 13123110, 6906900,
        3108105, 1184040, 376740, 98280, 20475, 3276, 378, 28, 1,
    ],
    &[
        536870912, 1, 29, 406, 3654, 23751, 118755, 475020, 1560780, 4292145, 10015005, 20030010,
        34597290, 51895935, 67863915, 77558760, 77558760, 67863915, 51895935, 34597290, 20030010,
        10015005, 4292145, 1560780, 475020, 118755, 23751, 3654, 406, 29, 1,
    ],
    &[
        1073741824, 1, 30, 435, 4060, 27405, 142506, 593775, 2035800, 5852925, 14307150, 30045015,
        54627300, 86493225, 119759850, 145422675, 155117520, 145422675, 119759850, 86493225,
        54627300, 30045015, 14307150, 5852925, 2035800, 593775, 142506, 27405, 4060, 435, 30, 1,
    ],
    &[
        2147483648, 1, 31, 465, 4495, 31465, 169911, 736281, 2629575, 7888725, 20160075, 44352165,
        84672315, 141120525, 206253075, 265182525, 300540195, 300540195, 265182525, 206253075,
        141120525, 84672315, 44352165, 20160075, 7888725, 2629575, 736281, 169911, 31465, 4495,
        465, 31, 1,
    ],
    &[
        4294967296, 1, 32, 496, 4960, 35960, 201376, 906192, 3365856, 10518300, 28048800, 64512240,
        129024480, 225792840, 347373600, 471435600, 565722720, 601080390, 565722720, 471435600,
        347373600, 225792840, 129024480, 64512240, 28048800, 10518300, 3365856, 906192, 201376,
        35960, 4960, 496, 32, 1,
    ],
    &[
        8589934592, 1, 33, 528, 5456, 40920, 237336, 1107568, 4272048, 13884156, 38567100,
        92561040, 193536720, 354817320, 573166440, 818809200, 1037158320, 1166803110, 1166803110,
        1037158320, 818809200, 573166440, 354817320, 193536720, 92561040, 38567100, 13884156,
        4272048, 1107568, 237336, 40920, 5456, 528, 33, 1,
    ],
    &[
        17179869184,
        1,
        34,
        561,
        5984,
        46376,
        278256,
        1344904,
        5379616,
        18156204,
        52451256,
        131128140,
        286097760,
        548354040,
        927983760,
        1391975640,
        1855967520,
        2203961430,
        2333606220,
        2203961430,
        1855967520,
        1391975640,
        927983760,
        548354040,
        286097760,
        131128140,
        52451256,
        18156204,
        5379616,
        1344904,
        278256,
        46376,
        5984,
        561,
        34,
        1,
    ],
    &[
        34359738368,
        1,
        35,
        595,
        6545,
        52360,
        324632,
        1623160,
        6724520,
        23535820,
        70607460,
        183579396,
        417225900,
        834451800,
        1476337800,
        2319959400,
        3247943160,
        4059928950,
        4537567650,
        4537567650,
        4059928950,
        3247943160,
        2319959400,
        1476337800,
        834451800,
        417225900,
        183579396,
        70607460,
        23535820,
        6724520,
        1623160,
        324632,
        52360,
        6545,
        595,
        35,
        1,
    ],
    &[
        68719476736,
        1,
        36,
        630,
        7140,
        58905,
        376992,
        1947792,
        8347680,
        30260340,
        94143280,
        254186856,
        600805296,
        1251677700,
        2310789600,
        3796297200,
        5567902560,
        7307872110,
        8597496600,
        9075135300,
        8597496600,
        7307872110,
        5567902560,
        3796297200,
        2310789600,
        1251677700,
        600805296,
        254186856,
        94143280,
        30260340,
        8347680,
        1947792,
        376992,
        58905,
        7140,
        630,
        36,
        1,
    ],
    &[
        137438953472,
        1,
        37,
        666,
        7770,
        66045,
        435897,
        2324784,
        10295472,
        38608020,
        124403620,
        348330136,
        854992152,
        1852482996,
        3562467300,
        6107086800,
        9364199760,
        12875774670,
        15905368710,
        17672631900,
        17672631900,
        15905368710,
        12875774670,
        9364199760,
        6107086800,
        3562467300,
        1852482996,
        854992152,
        348330136,
        124403620,
        38608020,
        10295472,
        2324784,
        435897,
        66045,
        7770,
        666,
        37,
        1,
    ],
    &[
        274877906944,
        1,
        38,
        703,
        8436,
        73815,
        501942,
        2760681,
        12620256,
        48903492,
        163011640,
        472733756,
        1203322288,
        2707475148,
        5414950296,
        9669554100,
        15471286560,
        22239974430,
        28781143380,
        33578000610,
        35345263800,
        33578000610,
        28781143380,
        22239974430,
        15471286560,
        9669554100,
        5414950296,
        2707475148,
        1203322288,
        472733756,
        163011640,
        48903492,
        12620256,
        2760681,
        501942,
        73815,
        8436,
        703,
        38,
        1,
    ],
];

/// Elevation of a Uuniform reduction by degree one of Bernstein polymial Bezier (with degree+1)
/// using points with t = i/(degree+1) for i in 0..degree+1
///
/// i.e. the elevated-reduced Bezier (of 'degree') will match at precisely *degree+1* equispaced (in t) points.
///
/// `ELEVATED_REDUCE_BY_ONE_BS_UNIFORM_F64[0]` is a 3x3 matrix to elevate+reduce a quadratic Bezier.
/// `ELEVATED_REDUCE_BY_ONE_BS_UNIFORM_F64[1]` is a 4x4 matrix to elevate+reduce a cubic Bezier.
///
/// i.e. `ELEVATED_REDUCE_BY_ONE_BS_UNIFORM_F64[n]` reduces a degree 'n+2' Bezier to a degree 'n+1' Bezier
pub const ELEVATED_REDUCE_BY_ONE_BS_UNIFORM_F64: &[&[f64]] = &[
    &[1.0, 0.0, 0.0, 0.5, 0.0, 0.5, 0.0, 0.0, 1.0],
    &[
        1.0,
        0.0,
        0.0,
        0.0,
        0.166666666666666,
        0.5,
        0.5,
        -0.16666666666666,
        -0.16666666666666,
        0.5,
        0.5,
        0.166666666666666,
        0.0,
        0.0,
        0.0,
        1.0,
    ],
    &[
        1.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.055_555_555_555_555_55,
        0.7777777777777777,
        0.3333333333333333,
        -0.2222222222222222,
        0.055_555_555_555_555_55,
        -0.092_592_592_592_592_59,
        0.37037037037037037,
        0.4444444444444444,
        0.37037037037037037,
        -0.09259259259259259,
        0.055_555_555_555_555_55,
        -0.222_222_222_222_222_2,
        0.3333333333333333,
        0.7777777777777777,
        0.055_555_555_555_555_55,
        0.0,
        0.0,
        0.0,
        0.0,
        1.0,
    ],
    &[
        1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.01875, 0.90625, 0.1875, -0.1875, 0.09375, -0.01875,
        -0.040625, 0.203125, 0.59375, 0.40625, -0.203125, 0.040625, 0.040625, -0.203125, 0.40625,
        0.59375, 0.203125, -0.040625, -0.01875, 0.09375, -0.1875, 0.1875, 0.90625, 0.01875, 0.0,
        0.0, 0.0, 0.0, 0.0, 1.0,
    ],
    &[
        1.,
        0.,
        0.,
        0.,
        0.,
        0.,
        0.,
        0.0063999999999999994,
        0.9615999999999999,
        0.09599999999999999,
        -0.12799999999999997,
        0.09599999999999999,
        -0.0384,
        0.0063999999999999994,
        -0.016426666666666666,
        0.09856,
        0.7535999999999999,
        0.3285333333333333,
        -0.24639999999999998,
        0.09856,
        -0.016426666666666666,
        0.021519999999999997,
        -0.12911999999999998,
        0.3228,
        0.5696,
        0.3228,
        -0.12911999999999998,
        0.021519999999999997,
        -0.016426666666666666,
        0.09856,
        -0.24639999999999998,
        0.3285333333333333,
        0.7535999999999999,
        0.09856,
        -0.016426666666666666,
        0.0063999999999999994,
        -0.0384,
        0.09599999999999999,
        -0.12799999999999997,
        0.09599999999999999,
        0.9615999999999999,
        0.0063999999999999994,
        0.,
        0.,
        0.,
        0.,
        0.,
        0.,
        1.,
    ],
    &[
        1.,
        0.,
        0.,
        0.,
        0.,
        0.,
        0.,
        0.,
        0.002204585537918871,
        0.9845679012345678,
        0.046296296296296294,
        -0.07716049382716049,
        0.07716049382716049,
        -0.046296296296296294,
        0.015432098765432098,
        -0.002204585537918871,
        -0.006393298059964726,
        0.044753086419753084,
        0.8657407407407407,
        0.22376543209876543,
        -0.22376543209876543,
        0.13425925925925924,
        -0.044753086419753084,
        0.006393298059964726,
        0.010008818342151674,
        -0.07006172839506172,
        0.21018518518518517,
        0.6496913580246914,
        0.3503086419753086,
        -0.21018518518518517,
        0.07006172839506172,
        -0.010008818342151674,
        -0.010008818342151674,
        0.07006172839506172,
        -0.21018518518518517,
        0.3503086419753086,
        0.6496913580246914,
        0.21018518518518517,
        -0.07006172839506172,
        0.010008818342151674,
        0.006393298059964726,
        -0.044753086419753084,
        0.13425925925925924,
        -0.22376543209876543,
        0.22376543209876543,
        0.8657407407407407,
        0.044753086419753084,
        -0.006393298059964726,
        -0.002204585537918871,
        0.015432098765432098,
        -0.046296296296296294,
        0.07716049382716049,
        -0.07716049382716049,
        0.046296296296296294,
        0.9845679012345678,
        0.002204585537918871,
        0.,
        0.,
        0.,
        0.,
        0.,
        0.,
        0.,
        1.,
    ],
];

/// Point-to-point preserving reduction by degree one of Bernstein polymial Bezier (with degree+1)
/// using points with t = i/(degree+1) for i in 0..degree+1
///
/// i.e. the reduced Bezier (of 'degree') will match at precisely *degree+1* equispaced (in t) points.
///
/// `REDUCE_BY_ONE_BS_UNIFORM_F64[0]` is a 2x3 matrix to reduce a quadratic to a linear (degree 1) Bezier.
/// `REDUCE_BY_ONE_BS_UNIFORM_F64[1]` is a 3x4 matrix to reduce a cubic to a quadratic (degree 2) Bezier.
///
/// i.e. `REDUCE_BY_ONE_BS_UNIFORM_F64[n]` reduces a degree 'n+2' Bezier to a degree 'n+1' Bezier
pub const REDUCE_BY_ONE_BS_UNIFORM_F64: &[&[f64]] = &[
    &[1., 0., 0., 0., 0., 1.],
    &[1., 0., 0., 0., -0.25, 0.75, 0.75, -0.25, 0., 0., 0., 1.0],
    &[
        1.0,
        0.0,
        0.0,
        0.0,
        0.0,
        -0.25925925925925936,
        1.0370370370370372,
        0.4444444444444444,
        -0.2962962962962963,
        0.07407407407407413,
        0.07407407407407413,
        -0.29629629629629634,
        0.4444444444444444,
        1.037037037037037,
        -0.2592592592592593,
        0.0,
        0.0,
        0.0,
        0.0,
        1.0,
    ],
    &[
        1.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        -0.2265625,
        1.1328125,
        0.234375,
        -0.234375,
        0.1171875,
        -0.0234375,
        0.0833333333333333,
        -0.4166666666666668,
        0.833333333333333,
        0.833333333333333,
        -0.41666666666666685,
        0.08333333333333326,
        -0.0234375,
        0.1171875,
        -0.234375,
        0.234375,
        1.1328125,
        -0.2265625,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        1.0,
    ],
    &[
        1.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        -0.1923199999999999,
        1.1539199999999992,
        0.11520000000000002,
        -0.15359999999999982,
        0.11520000000000019,
        -0.046079999999999566,
        0.007680000000000214,
        0.07151999999999979,
        -0.4291199999999985,
        1.0728000000000002,
        0.5695999999999997,
        -0.42720000000000014,
        0.17087999999999925,
        -0.028480000000000283,
        -0.028480000000000096,
        0.17087999999999878,
        -0.4272,
        0.5695999999999997,
        1.0727999999999998,
        -0.4291199999999993,
        0.07152000000000025,
        0.007679999999999966,
        -0.04607999999999961,
        0.11519999999999996,
        -0.15359999999999996,
        0.11519999999999997,
        1.1539199999999998,
        -0.19232000000000027,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        1.0,
    ],
    &[
        1.,
        0.,
        0.,
        0.,
        0.,
        0.,
        0.,
        0.,
        -0.1640946502057613,
        1.148662551440329,
        0.05401234567901234,
        -0.09002057613168724,
        0.09002057613168724,
        -0.05401234567901234,
        0.018004115226337446,
        -0.0025720164609053494,
        0.0566872427983539,
        -0.3968106995884773,
        1.190432098765432,
        0.3492798353909465,
        -0.3492798353909465,
        0.2095679012345679,
        -0.0698559670781893,
        0.009979423868312756,
        -0.024999999999999998,
        0.175,
        -0.5249999999999999,
        0.875,
        0.875,
        -0.5249999999999999,
        0.175,
        -0.024999999999999998,
        0.009979423868312756,
        -0.0698559670781893,
        0.2095679012345679,
        -0.3492798353909465,
        0.3492798353909465,
        1.190432098765432,
        -0.3968106995884773,
        0.0566872427983539,
        -0.0025720164609053494,
        0.018004115226337446,
        -0.05401234567901234,
        0.09002057613168724,
        -0.09002057613168724,
        0.05401234567901234,
        1.148662551440329,
        -0.1640946502057613,
        0.,
        0.,
        0.,
        0.,
        0.,
        0.,
        0.,
        1.,
    ],
];
